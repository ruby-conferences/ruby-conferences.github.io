{% comment %} Handle both single meetup and grouped meetups {% endcomment %}
{% if meetup_group %}
  {% assign meetups_to_display = meetup_group %}
{% else %}
  {% assign meetups_to_display = meetup | split: "" | push: meetup %}
{% endif %}

{% assign first_meetup = meetups_to_display | first %}

<div class="list-item {{ first_meetup.date | date: '%Y%m' }} {% continent %}{{ first_meetup.location | split: ', ' | last }}{% endcontinent %}">
  <dt>
    {% if first_meetup.url %}
      <a href="{{ first_meetup.url }}">{{ first_meetup.name }}</a>
    {% else %}
      <a>{{ first_meetup.name }}</a>
    {% endif %}

    {% if first_meetup.status %}
      <div class="status" data-phrase="{{ first_meetup.status }}"></div>
    {% endif %}
  </dt>

  <dd>
    <ul>
      <li>{{ first_meetup.date | date: "%B %-d, %Y" }}</li>
      <li>{{ first_meetup.location }}</li>
      {% if meetups_to_display.size > 1 %}
        <li>
          {% for m in meetups_to_display %}
            {% assign detected_service = m.service %}
            {% unless detected_service %}
              {% if m.url contains "meetup.com" %}
                {% assign detected_service = "meetup" %}
              {% elsif m.url contains "lu.ma" or m.url contains "luma.com" %}
                {% assign detected_service = "luma" %}
              {% endif %}
            {% endunless %}

            {% if detected_service == "meetup" %}
              <a href="{{ m.url }}">Meetup.com</a>
            {% elsif detected_service == "luma" %}
              <a href="{{ m.url }}">Luma.com</a>
            {% else %}
              <a href="{{ m.url }}">Link</a>
            {% endif %}
            {% unless forloop.last %} â€¢ {% endunless %}
          {% endfor %}
        </li>
      {% endif %}
    </ul>
  </dd>
</div>
